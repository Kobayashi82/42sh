# Tests

## 1. History Expansions

### Búsqueda por Índice Negativo (`!-number`)

- `!!` → Ejecuta el último comando
- `!-1` → Ejecuta el último comando (igual que `!!`)
- `!-3` → Ejecuta el comando 3 posiciones antes del actual
- `!-0` → Error: "Event not found"
- Sin historial: `!!` → Error: "Event not found"

### Búsqueda por Número de Evento (`!number`)

- `!1` → Ejecuta el comando número 1 del historial
- `!999999` → Error: "Event not found"
- `!0` → Error: "Event not found"

### Búsqueda por Prefijo (`!word`)

```bash
ls
grep test
!gr   # Debe ejecutar: grep test
!ls   # Ejecuta: ls
!noexist  # Error: "Event not found"
```

---

## 2. Persistencia de Historia

### Variables de Entorno

- `HISTFILE` - Archivo donde se guarda el historial
- `HISTSIZE` - Número de comandos en memoria
- `HISTFILESIZE` - Número de líneas en el archivo
- `HISTCONTROL` - Opciones: `ignoredups`, `ignorespace`, `erasedups`, `ignoreboth`

### Test Cases

- [ ] Limitar historial a 10 comandos
- [ ] Verificar truncamiento automático
- [ ] Verificar que solo se guardan los últimos comandos añadidos
- [ ] Cerrar shell, reabrir y comprobar persistencia
- [ ] Comando vacío no debe guardarse
- [ ] Comando con espacio al principio no debe añadirse (con `ignorespace`)

---

## 3. Búsqueda Incremental (Ctrl+R)

- [ ] Buscar con múltiples coincidencias
  - Ctrl+R → siguiente coincidencia hacia atrás
  - Ctrl+S → siguiente coincidencia hacia adelante
- [ ] Búsqueda sin resultados
- [ ] Cancelar búsqueda
  - Ctrl+C → cancela y limpia línea
  - Ctrl+G → cancela y mantiene línea actual

---

## 4. Modo Vi

### Movimiento (con conteos)

- `3w` → Mover 3 palabras adelante
- `5h` → Retroceder 5 caracteres
- `$` → Fin de línea
- `0` → Inicio de línea
- `fX` → Salta a próxima 'X'
- `;` → Repite último salto

### Edición

- `dw` / `3dw` → Borrar palabra(s)
- `yy` / `3yy` → Copiar línea(s)
- `p` / `P` → Pegar después/antes del cursor
- `ci"` → Cambiar contenido dentro de comillas
- `rX` → Reemplazar carácter actual por 'X'

### Undo/Redo

- `u` → Deshacer última operación
- `U` → Restaurar línea completa
- Múltiples `u` → Deshacer operaciones sucesivas
- `Ctrl-R` → Rehacer (si está implementado)

### Modos

- `i` / `a` → Entrar en modo inserción (antes/después del cursor)
- `A` → Insertar al final de línea
- `R` → Modo sobrescribir

---

## 5. Modo Readline (Emacs)

### Navegación

- `Ctrl-p` / `Ctrl-n` → Navegar historial (↑/↓)
- `Ctrl-f` / `Ctrl-b` → Moverse por caracteres (→/←)

### Edición

- `Ctrl-t` → Transponer caracteres
  - Ejemplo: "tset" → "test"
- `Alt-t` → Transponer palabras
  - Ejemplo: "world hello" → "hello world"
- `Ctrl-_` → Undo progresivo

---

## 6. Casos Edge/Bizarros

### Undo Extremo

- [ ] Hacer 10 cambios → 10 veces `u` → ¿Vuelve al estado original?
- [ ] `u` en modo comando sin cambios previos → ¿Comportamiento correcto?

### Conteos Excesivos

- [ ] `999999dw` en línea corta → Debe borrar hasta el final
- [ ] `y999y` → ¿Maneja memoria correctamente?

### Límites de Línea

- [ ] `x` al final de línea → No hace nada
- [ ] `$D` → Borra hasta fin de línea (deja línea vacía)
- [ ] `0C` → Borra todo y entra en modo inserción

### Combinaciones Extrañas

- [ ] `d2w` seguido de `u` → ¿Restaura las 2 palabras borradas?
- [ ] `c3e` → Cambiar hasta el 3er fin de palabra
- [ ] `fc -e -` → Usar stdin como editor

---

## 7. Interacción entre Modos

- [ ] Cambiar de Vi a Readline durante edición
  - `set -o vi` / `set -o emacs`
  - Verificar que keybindings se actualizan inmediatamente

---

## 8. Manejo de Errores

- [ ] Comandos inválidos en modo comando Vi (ej: `z`) → Ignorar/Beep
- [ ] `fc -l invalid` → Error de sintaxis
- [ ] `!-0` → Manejo correcto de índice 0

---

## 9. Rendimiento

- [ ] Historial de 10,000 entradas
  - Ctrl+R debe responder fluidamente
- [ ] Línea de 10,000 caracteres
  - Operaciones como `$` deben ser instantáneas

  
123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890